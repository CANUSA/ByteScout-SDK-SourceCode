<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>HTMLToPDF JQuery sample</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
</head>
<body>

  <form id='form'>
    <p>
      <label>Copy-paste your API Key for Bytescout.IO here</label>
      <input type='text' id='apikey' placeholder='ApiKey'/>
    </p>
    <p>
      <label>InputLink</label>
      <input type="text" name='link' id='inputLink' placeholder='https://www.google.com/'>
    </p>
    <p>
      <label>or InputValue (HTML code)</label>
      <textarea id='inputValue'></textarea>
    </p>
    <p><label>Margins:</label>
      <label>Left</label>
      <input type="number" id="marginLeft">
      <label>Top</label>
      <input type="number" id="marginTop">
      <label>Right</label>
      <input type="number" id="marginRight">
      <label>Bottom</label>
      <input type="number" id="marginBottom">
    </p>
    <button type='button' id='submit'>Convert</button>
  </form>

  <div id='errorBlock'>
    <h2>Error:</h2>
    <h4>Code: <span id='statusCode'></span></h4>
    <ul id="errors"></ul>
  </div>

  <div id='resultBlock'>
    <h2>Result:</h2>
    <pre id='result'></pre>
  </div>

  <script>
    $(document).ready(function(){
      $('#resultBlock').hide();
      $('#errorBlock').hide();
    });

    $(document).on('click', '#submit',function(){
      $('#resultBlock').hide();
      $('#errorBlock').hide();

    var apikey = $('#apikey').val().trim(); //Get your API key by registering at http://www.bytescout.com/

    var url = 'https://bytescout.io/api/v1/htmltopdf/convert';

    var options = {
      "Options": {
        "Orientation": "Landscape",
        "Margin": {
          "Top": $('#marginTop').val(),
          "Bottom": $('#marginBottom').val(),
          "Left": $('#marginLeft').val(),
          "Right": $('#marginRight').val()
        },
      },
      "InputLink": $('#inputLink').val(),
      "InputValue": $('#inputValue').val(),
      "OutputType": "Link"
    };

    $.ajax({
      url: url,
      type: 'POST',
      data: JSON.stringify(options), 
      contentType: 'application/json',
      beforeSend: function(xhr){
        xhr.setRequestHeader('apikey', apikey);
      },
      success: function(response){
        $('#resultBlock').show();
        $('#result').html(response);
        window.open(response);
      },
      error: function(response){
        $('#errorBlock').show();
        $('#statusCode').html(response.status);
        $('#errors').html('');
        $.each(response.responseJSON.Errors, function(){
          $('#errors').append($('<li></li>').html(this));
        })
      },
    });
  });

</script>
</body>
</html>